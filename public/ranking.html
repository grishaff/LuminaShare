<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LuminaShare ‚Äì –†–µ–π—Ç–∏–Ω–≥ –¥–æ–Ω–æ—Ä–æ–≤</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="min-h-screen flex flex-col" style="background: linear-gradient(301deg,#7b2ff2 0%,#f357a8 100%);">
    <!-- Header -->
    <header class="bg-white shadow-md p-4 flex items-center justify-between">
      <button id="backBtn" class="text-lg">‚Üê –ù–∞–∑–∞–¥</button>
      <h1 class="text-xl font-semibold">üèÜ –†–µ–π—Ç–∏–Ω–≥ –¥–æ–Ω–æ—Ä–æ–≤</h1>
      <div></div>
    </header>

    <!-- Content -->
    <main class="flex-1 p-4">
      <div class="bg-white/90 backdrop-blur-md rounded-2xl shadow-xl p-6 max-w-2xl mx-auto">
        <div id="ranking" class="space-y-4">
          <p class="text-center text-gray-500">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
      </div>
    </main>

    <script>
      // Telegram Web App initialization
      let tg = window.Telegram?.WebApp;
      if (tg) {
        tg.ready();
        tg.expand();
      }

      // Back button
      document.getElementById('backBtn').addEventListener('click', () => {
        window.location.href = '/';
      });

      // Load ranking
      async function loadRanking() {
        try {
          const resp = await fetch('/api/ranking');
          const json = await resp.json();
          const ranking = json.ranking || [];
          
          const container = document.getElementById('ranking');
          
          if (ranking.length === 0) {
            container.innerHTML = '<p class="text-center text-gray-500">–ü–æ–∫–∞ –Ω–µ—Ç –¥–æ–Ω–∞—Ç–æ–≤</p>';
            return;
          }

          container.innerHTML = ranking.map((donor, index) => {
            const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
            
            return `
              <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                <div class="flex items-center space-x-3">
                  <span class="text-lg font-bold">${medal}</span>
                  <div>
                    <p class="font-semibold">${donor.first_name || '–ê–Ω–æ–Ω–∏–º'}</p>
                    <p class="text-sm text-gray-500">${donor.donation_count} –¥–æ–Ω–∞—Ç–æ–≤</p>
                  </div>
                </div>
                <div class="text-right">
                  <p class="font-bold text-green-600">${donor.total_amount} TON</p>
                </div>
              </div>
            `;
          }).join('');
          
        } catch (err) {
          document.getElementById('ranking').innerHTML = `<p class="text-red-500 text-center">–û—à–∏–±–∫–∞: ${err}</p>`;
        }
      }

      loadRanking();
    </script>
  </body>
</html> 